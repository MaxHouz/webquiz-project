function generateId(e){var n=[];for(key in e){var r=key.match(/[0-9]{1,}/)[0];n.push(r)}return n.length?arrayMax(n)+1:1}function arrayMax(e){return Math.max.apply(null,e)}function addUser(e){var n="user"+generateId(usersObject),r="user1"===n?{}:usersObject;r[n]={login:e,quizes:[]},localStorage.setItem("users",JSON.stringify(r))}function logIn(){function e(){"new-user-yes"===this.id?(addUser(t),n()):"new-user-no"===this.id&&newUserForm.classList.remove("active")}function n(){usersObject=JSON.parse(localStorage.getItem("users")),r=getIdbbyName(t),window.location="?userid="+r}var r,t=loginInput.value;if(userCheck(t))n();else{newUserForm.classList.add("active");for(var o=0;o<newUserConf.length;o++)newUserConf[o].addEventListener("click",e)}}function userCheck(e){for(key in usersObject)if(usersObject[key].login==e)return!0;return!1}function getIdbbyName(e){var n;for(key in usersObject)usersObject[key].login==e&&(n=key);return n}function userControl(){var e=document.querySelector(".quiz_start"),n=document.querySelector(".login_anchor");queryArray=window.location.search.split("&"),(currentUser=queryArray[0].split("=")[1])||(e.style.display="none",n.style.display="block",n.addEventListener("click",showLogInForm))}function formLink(e,n){var r,t;return-1==e.indexOf("#")?(t=e.split("?"),r=t[0]+"?userid="+n+(t[1]?"&"+t[1]:"")):-1==e.indexOf("userid")?(t=e.split("#"),r=t[0]+"?userid="+n+"#"+t[1]):(t=e.split("#"),r="#"+t[1]),r}function showLogInForm(){loginForm.classList.add("active"),loginItem.classList.add("active")}function logout(){if(currentUser){var e=document.querySelector(".header_menu-link.log");e.innerHTML="Log out",e.addEventListener("click",function(e){e.preventDefault();var n=window.location.pathname;window.location=n.split("?")[0]})}}function blockLogInForm(){void 0===currentUser&&loginBtn.addEventListener("click",function(e){e.preventDefault(e),loginForm.classList.toggle("active"),loginItem.classList.toggle("active")})}var usersObject=JSON.parse(localStorage.getItem("users")),loginInput=document.querySelector(".login_input"),loginConfirm=document.querySelector(".login_confirm"),newUserForm=document.querySelector(".new_user"),newUserConf=document.querySelectorAll(".new_user-conf"),newUserYes=document.getElementById("new-user-yes"),newUserNo=document.getElementById("new-user-no");loginInput.addEventListener("keyup",function(e){13===e.keyCode&&loginConfirm.click()}),loginConfirm.addEventListener("click",logIn);var currentUser;document.addEventListener("DOMContentLoaded",userControl),document.addEventListener("DOMContentLoaded",logout);var searchBtn=document.getElementById("search"),searchInput=document.getElementById("search_input");searchBtn.addEventListener("change",function(){searchInput.classList.toggle("active")});var userElems=document.querySelectorAll(".user"),fastLinks=document.querySelectorAll(".quizes_dropdown-link"),menuItems=document.querySelectorAll(".header_menu-link"),homeLogo=document.querySelector(".header_logo-link");if(queryArray=window.location.search.split("&"),currentUser=queryArray[0].split("=")[1]){homeLogo.href=formLink(homeLogo.href,currentUser);for(var j=0;j<menuItems.length;j++)menuItems[j].href=formLink(menuItems[j].href,currentUser);for(var i=0;i<fastLinks.length;i++)fastLinks[i].href=formLink(fastLinks[i].href,currentUser)}else for(var i=0;i<userElems.length;i++)userElems[i].addEventListener("click",function(e){e.preventDefault(),showLogInForm()});document.addEventListener("DOMContentLoaded",blockLogInForm);var loginBtn=document.querySelector(".header_menu-link.log"),loginForm=document.querySelector(".login_form"),loginItem=document.querySelector(".header_menu-item.log");